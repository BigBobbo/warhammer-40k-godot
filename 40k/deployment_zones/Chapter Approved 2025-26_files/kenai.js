try { !function(){function e(e,i){(null==i||i>e.length)&&(i=e.length);for(var t=0,r=new Array(i);t<i;t++)r[t]=e[t];return r}function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function t(e,i){if(!(e instanceof i))throw new TypeError("Cannot call a class as a function")}function r(e,i){for(var t=0;t<i.length;t++){var r=i[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function n(e,i,t){return i&&r(e.prototype,i),t&&r(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function o(e,i,t){return i in e?Object.defineProperty(e,i,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[i]=t,e}if("function"!=typeof PrebidImpressionController){var a=function(){function e(){t(this,e),o(this,"storeUrl","/detroitchicago/bluemonkey.gif"),o(this,"ezPixel",null),o(this,"initDone",!1),o(this,"initRetries",20),o(this,"queue",[]),o(this,"sampleRate",10),o(this,"prebidImpressions",{}),o(this,"auctions",{}),o(this,"slotAuctions",{}),o(this,"videoAuctions",{}),o(this,"rateUUIDMemo",{}),this.init()}return n(e,[{key:"init",value:function(){var e,i,t=this;if("function"!=typeof(null===(e=window.__ez)||void 0===e?void 0:e.Pixel)||void 0===(null===(i=window.__ez)||void 0===i?void 0:i.dot)){if(this.initRetries<=0)return;return this.initRetries--,void setTimeout((function(){t.init()}),1e3)}this.ezPixel=new __ez.Pixel(this.storeUrl),this.setBuilder(),this.initDone=!0,this.processQueue()}},{key:"setBuilder",value:function(){var e=this;this.ezPixel.setPixelBuilder((function(i){if(0!==e.sampleRate){var t=i.pixelData;return t.sample_multiplier=100/e.sampleRate,t}})),this.ezPixel.setFireConfig({postPixels:!0,batchSize:40})}},{key:"add",value:function(e){this.initDone?this.ezPixel.Add(e):this.queue.push(e)}},{key:"processQueue",value:function(){if(0!==this.queue.length){for(var e=0;e<this.queue.length;e++)this.add(this.queue[e]);this.queue=[]}}},{key:"recordAndFireImpressionWonEvent",value:function(e){if(this.isVisitSampledIn()){e.bid_won=1;var i=null;try{i=new PrebidImpression(e,!0)}catch(e){return void console.warn("PrebidImpressionController: Invalid PrebidImpression object for bid won event, skipping.",e)}this.add(i)}}},{key:"recordAuctionEndImpressions",value:function(e){var i=this;if(this.isVisitSampledIn()){var t={},r={};try{Array.isArray(null==e?void 0:e.adUnits)&&e.adUnits.forEach((function(e){e&&e.adUnitId&&(r[e.adUnitId]=e)}))}catch(e){}this.assignFloorsToBids(e),(Array.isArray(null==e?void 0:e.bidderRequests)?e.bidderRequests:[]).forEach((function(e){0!==e.bids.length&&e.bids.forEach((function(e){try{var n,o=null;e.adUnitId&&r[e.adUnitId]&&(o=r[e.adUnitId]);var a=i.getTflLengthFromAdUnit(o);"number"==typeof a&&(e._tfl_length=a),null!==(n=o)&&void 0!==n&&n.bidPoolId&&(e._bid_pool_id=o.bidPoolId)}catch(e){}try{t[e.bidId]&&console.warn("PrebidImpressionController: Impression already exists for bidId ".concat(e.bidId,", about to rewrite it"),JSON.parse(JSON.stringify(t[e.bidId]))),t[e.bidId]=new PrebidImpression(e,!1)}catch(e){return void console.warn("PrebidImpressionController: Invalid PrebidImpression object for bidder request, skipping.",e)}}))})),(Array.isArray(null==e?void 0:e.bidsReceived)?e.bidsReceived:[]).forEach((function(e){if(t.hasOwnProperty(e.requestId)){try{var n,o=null;e.adUnitId&&r[e.adUnitId]&&(o=r[e.adUnitId]);var a=i.getTflLengthFromAdUnit(o);"number"==typeof a&&(e._tfl_length=a),null!==(n=o)&&void 0!==n&&n.bidPoolId&&(e._bid_pool_id=o.bidPoolId)}catch(e){}t[e.requestId].addAndTransformFields(e)}else try{try{var s,d=null;e.adUnitId&&r[e.adUnitId]&&(d=r[e.adUnitId]);var l=i.getTflLengthFromAdUnit(d);"number"==typeof l&&(e._tfl_length=l),null!==(s=d)&&void 0!==s&&s.bidPoolId&&(e._bid_pool_id=d.bidPoolId)}catch(e){}t[e.requestId]=new PrebidImpression(e,!0)}catch(e){return void console.warn("PrebidImpressionController: Invalid PrebidImpression object for bid received, skipping.",e)}})),(Array.isArray(null==e?void 0:e.bidsRejected)?e.bidsRejected:[]).forEach((function(e){if(t.hasOwnProperty(e.requestId)){try{var n,o=null;e.adUnitId&&r[e.adUnitId]&&(o=r[e.adUnitId]);var a=i.getTflLengthFromAdUnit(o);"number"==typeof a&&(e._tfl_length=a),null!==(n=o)&&void 0!==n&&n.bidPoolId&&(e._bid_pool_id=o.bidPoolId)}catch(e){}e.rejectionReason&&(e._prebid_rejection_reason=e.rejectionReason),t[e.requestId].addAndTransformFields(e)}else try{try{var s,d=null;e.adUnitId&&r[e.adUnitId]&&(d=r[e.adUnitId]);var l=i.getTflLengthFromAdUnit(d);"number"==typeof l&&(e._tfl_length=l),null!==(s=d)&&void 0!==s&&s.bidPoolId&&(e._bid_pool_id=d.bidPoolId)}catch(e){}e.rejectionReason&&(e._prebid_rejection_reason=e.rejectionReason),t[e.requestId]=new PrebidImpression(e,!0)}catch(e){return void console.warn("PrebidImpressionController: Invalid PrebidImpression object for rejected bid, skipping.",e)}})),this.prebidImpressions=Object.assign(this.prebidImpressions,t)}}},{key:"getTflLengthFromAdUnit",value:function(e){try{var i,t,r,n,o,a,s;if(!e)return;if(Array.isArray(e.tfl))return e.tfl.length;var d=null==e||null===(i=e.ortb2Imp)||void 0===i||null===(t=i.ext)||void 0===t||null===(r=t.prebid)||void 0===r||null===(n=r.floors)||void 0===n?void 0:n.tfl;if(Array.isArray(d))return d.length;var l=null==e||null===(o=e.ext)||void 0===o||null===(a=o.prebid)||void 0===a||null===(s=a.floors)||void 0===s?void 0:s.tfl;if(Array.isArray(l))return l.length}catch(e){}}},{key:"batchFireAll",value:function(){this.isVisitSampledIn()&&(this.batchFire(Object.values(this.prebidImpressions)),this.prebidImpressions={})}},{key:"batchFire",value:function(e){if(this.isVisitSampledIn()&&null!==e&&0!==e.length)for(var i=0;i<e.length;i++)e[i]instanceof PrebidImpression?this.add(e[i]):console.warn("PrebidImpressionController: Invalid impression object in batchFire, skipping.")}},{key:"getFloorFromBid",value:function(e){if(e){var i;if("s2s"===e.src){var t=e.ortb2Imp;if(t&&t.ext&&t.ext.hasOwnProperty("prebid")&&t.ext.prebid.hasOwnProperty("floors")){var r=t.ext.prebid.floors;r&&r.hasOwnProperty("floor")&&(i=r.floor),r&&r.hasOwnProperty("floormin")&&(i=r.floormin)}}for(var n=0,o=["floor","bidFloor","bidfloor","reserve","floorPrice","floorprice","customFloor","kadfloor"];n<o.length;n++){var a=o[n];if(e.params&&e.params.hasOwnProperty(a)){i=e.params[a];break}}if("string"==typeof i&&(i=parseFloat(i)),"number"==typeof i&&!isNaN(i))return i;if("function"==typeof e.getFloor){var s=e.getFloor();if(s&&s.floor)return s.floor}}}},{key:"assignFloorsToBids",value:function(e){if(e&&e.bidderRequests)for(var i=e.bidderRequests,t=0;t<i.length;t++)for(var r=0;r<i[t].bids.length;r++){var n=this.getFloorFromBid(i[t].bids[r]);"number"!=typeof n||isNaN(n)||(i[t].bids[r].ezFloor=n)}}},{key:"isVisitSampledIn",value:function(){var e,i=null===(e=window._ezaq)||void 0===e?void 0:e.visit_uuid;return i?this.calculateRateUUID(this.sampleRate,i):(console.warn("PrebidImpressionController: No visit UUID found, cannot sample in."),!1)}},{key:"calculateRateUUID",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if("number"!=typeof e||isNaN(e)||e<0||e>100)return console.warn("PrebidImpressionController: Invalid rate for sampling in, rate: ",e),!1;if("string"!=typeof i||0===i.length)return console.warn("PrebidImpressionController: Invalid UUID for sampling in, uuid: ",i),!1;var t=0;if(Object.prototype.hasOwnProperty.call(this.rateUUIDMemo,i))t=this.rateUUIDMemo[i];else{for(var r=0;r<i.length;r++)t=(t<<5)-t+i.charCodeAt(r),t|=0;this.rateUUIDMemo[i]=t}var n=t>>>0;return n/Math.pow(2,32)<e/100}}]),e}();window.PrebidImpressionController=new a}if("function"!=typeof PrebidImpression){var s=function(){function r(e,i){var n,a;if(t(this,r),o(this,"pixelData",{}),this.addAndTransformFields(e),!this.pixelData.request_id)throw new Error("Missing required fields for PrebidImpression");if(this.setPageLevelFields(),i)return this.pixelData.is_event=!0,void(this.pixelData.bid_won=e.bid_won||0);if(null!==(n=e.mediaTypes)&&void 0!==n&&n.video)this.setVideoFields(e);else{if(null===(a=e.mediaTypes)||void 0===a||!a.banner)throw new Error("PrebidImpression: Unknown media type for impression: "+JSON.stringify(e.mediaTypes));this.setDisplayFields(e)}}return n(r,[{key:"setPageLevelFields",value:function(){var e;void 0!==window._ezaq?(this.pixelData.pageview_id=_ezaq.page_view_id,this.pixelData.domain_id=parseInt(_ezaq.domain_id),this.pixelData.form_factor_id=parseInt(_ezaq.form_factor_id),this.pixelData.ab_test_id=_ezaq.ab_test_id,this.pixelData.url=window.location.href,this.pixelData.country=_ezaq.country,this.pixelData.epoch=(new Date).getTime(),_ezaq.t_epoch&&(this.pixelData.t_pageview_epoch=_ezaq.t_epoch),this.pixelData.has_ezids=this.checkEzids(),null!==(e=window.epbjs)&&void 0!==e&&e.SS&&this.pixelData.adapter_code&&window.epbjs.SS.hasOwnProperty(this.pixelData.adapter_code.toLowerCase())&&(this.pixelData.stat_source_id=parseInt(window.epbjs.SS[this.pixelData.adapter_code.toLowerCase()]))):console.warn("PrebidImpression: _ezaq not available")}},{key:"setVideoFields",value:function(e){var i,t,r,n,o,a,s,d,l,u,c,p,f,h,v=this;if(null!==(i=window.__ez)&&void 0!==i&&null!==(t=i.vhb)&&void 0!==t&&null!==(r=t.breaks)&&void 0!==r&&r[e.adUnitCode]?this.pixelData.impression_id=__ez.vhb.breaks[e.adUnitCode].impressionId:null!==(n=window.__ez)&&void 0!==n&&null!==(o=n.vhb)&&void 0!==o&&null!==(a=o.floatingBreaks)&&void 0!==a&&a[e.adUnitCode]&&(this.pixelData.impression_id=__ez.vhb.floatingBreaks[e.adUnitCode].impressionId),null!==(s=e.mediaTypes)&&void 0!==s&&null!==(d=s.video)&&void 0!==d&&d.context&&(this.pixelData.media_type=e.mediaTypes.video.context),"instream"==this.pixelData.media_type&&null!==(l=window.__ezInstream)&&void 0!==l&&l.prebidBidders){var b=__ezInstream.prebidBidders.filter((function(e){return e.bidder===v.pixelData.adapter_code}));b.length>0&&(this.pixelData.stat_source_id=parseInt(b[0].ssid))}if("outstream"==this.pixelData.media_type&&null!==(u=window.__ezOutstream)&&void 0!==u&&u.prebidBidders){var m=__ezOutstream.prebidBidders.filter((function(e){return e.bidder===v.pixelData.adapter_code}));m.length>0&&(this.pixelData.stat_source_id=parseInt(m[0].ssid))}null!==(c=e.mediaTypes)&&void 0!==c&&null!==(p=c.video)&&void 0!==p&&p.w&&null!==(f=e.mediaTypes)&&void 0!==f&&null!==(h=f.video)&&void 0!==h&&h.h&&(this.pixelData.request_size=e.mediaTypes.video.w+"x"+e.mediaTypes.video.h)}},{key:"setDisplayFields",value:function(e){var i,t,r,n,o;this.pixelData.media_type="banner",null!==(i=e.mediaTypes)&&void 0!==i&&null!==(t=i.banner)&&void 0!==t&&t.sizes&&Array.isArray(e.mediaTypes.banner.sizes)&&(this.pixelData.request_size=e.mediaTypes.banner.sizes.map((function(e){return e.join("x")})).join(",").substring(0,64));var a=this.getEzSlotTargetingForAdCode("string"==typeof(null==e?void 0:e.adUnitCode)?e.adUnitCode:"");if("function"==typeof(null===(r=window.googletag)||void 0===r?void 0:r.pubads)&&"function"==typeof(null===(n=window.googletag)||void 0===n?void 0:n.pubads().getSlots)){var s=googletag.pubads().getSlots().filter((function(i){return i.getSlotElementId()===e.adUnitCode}))[0];s&&(a=s.getTargetingMap())}if(null!==(o=e.ortb2Imp)&&void 0!==o&&o.instl&&(this.pixelData.position_type=6),a){var d=a.tap||"";(d=(d+"").split("-")).length>1&&(this.pixelData.impression_id=parseInt(d[d.length-1])),a.al&&(this.pixelData.position_type=parseInt(a.al)%1e3||-1),a.alc&&(this.pixelData.refresh_count=parseInt(a.alc)||1)}}},{key:"getEzSlotTargetingForAdCode",value:function(e){if("string"!=typeof e||0===e.length)return{};if(void 0!==window.ezOrca&&window.ezOrca.slotsRegistered){var t=this.getSlotFromOrca(e);if(t){var r={};if(t.store&&"object"===i(t.store)&&Object.assign(r,t.store),t.raw&&"object"===i(t.raw)&&Object.assign(r,t.raw),"function"==typeof t.getTargeting)for(var n=0,o=["al","tap","alc","ap","pt"];n<o.length;n++){var a=o[n],s=t.getTargeting(a);""!==s&&void 0!==s&&(r[a]=s)}if(Object.keys(r).length>0)return r}}if(!Array.isArray(window.ezslots_raw))return{};var d=window.ezslots_raw.filter((function(i){if(!i.tap||!i.tap.includes("-"))return!1;var t=i.tap.split("-").slice(1,-1).join("-");if(!t){if(!e.startsWith("div-gpt-ad"))return!1;var r=(t=e.replace("div-gpt-ad-","")).lastIndexOf("-");return r>0&&(t=t.substring(0,r)),t.length>0&&i.tap.startsWith(t)}return t.length>0&&e.includes(t)}));return d.length?d[0]:{}}},{key:"getSlotFromOrca",value:function(e){if(!window.ezOrca)return null;if("function"==typeof window.ezOrca.getSlotById){var i=window.ezOrca.getSlotById(e);if(i)return i;if("function"==typeof window.ezOrca.getCleanDivId){var t=window.ezOrca.getCleanDivId(e);if(t&&t!==e&&(i=window.ezOrca.getSlotById(t)))return i}}return null}},{key:"addAndTransformFields",value:function(e){var i,t,r,n=this,o={auctionId:"auction_id",bidId:"request_id",requestId:"request_id",adapterCode:"adapter_code",bidder:"adapter_code",adUnitCode:"ad_unit_code",cpm:"cpm",originalCpm:"original_cpm",timeToRespond:"time_to_respond",size:"response_size",src:"source",ezFloor:"floor"};Object.keys(e).forEach((function(i){if(o.hasOwnProperty(i)){var t=o[i];n.pixelData[t]=e[i]}})),this.addRejectionReason(e),this.addCategoryTracking(e);try{if("number"==typeof e._tfl_length){var a=this.pixelData.source||e.src||"",s=(this.pixelData.adapter_code||e.bidder||"").toLowerCase();"s2s"===a&&(s.includes("inmobi")||s.includes("pubmatic"))||(this.pixelData.tfl_length=e._tfl_length)}}catch(e){}try{e._bid_pool_id&&(this.pixelData.bid_pool_id=String(e._bid_pool_id).substring(0,64))}catch(e){}null!==(i=e.meta)&&void 0!==i&&i.advertiserDomains&&(this.pixelData.advertiser_domains=e.meta.advertiserDomains.join(",").substring(0,1023)),e.dealId&&(this.pixelData.deal_id=String(e.dealId)),e.creativeId&&(this.pixelData.creative_id=String(e.creativeId)),null!==(t=e.meta)&&void 0!==t&&t.networkName&&(this.pixelData.network_name=e.meta.networkName),null!==(r=e.meta)&&void 0!==r&&r.networkId&&(this.pixelData.network_id=String(e.meta.networkId)),e.cpm&&e.originalCpm&&e.originalCpm>0&&(this.pixelData.adjustment=e.cpm/e.originalCpm);try{var d=this.extractBidderParams(e);if(d){var l={};Object.keys(d).sort().forEach((function(e){l[e]=d[e]}));var u=JSON.stringify(l);this.pixelData.bidder_params=u.length>1023?u.substring(0,1023):u}}catch(e){}}},{key:"addRejectionReason",value:function(e){try{e._prebid_rejection_reason&&(this.pixelData.prebid_rejection_reason=e._prebid_rejection_reason.substring(0,255))}catch(e){console.warn("PrebidImpression: Error in addRejectionReason",e)}}},{key:"addCategoryTracking",value:function(e){try{var i,t,r,n=this.getOrtb2FromBidRequest(e);null!=n&&null!==(i=n.site)&&void 0!==i&&i.cat&&Array.isArray(n.site.cat)&&(this.pixelData.site_iab_categories=n.site.cat.map((function(e){return e.toString()})).sort().join(",").substring(0,32)),null!=n&&null!==(t=n.site)&&void 0!==t&&t.pagecat&&Array.isArray(n.site.pagecat)&&(this.pixelData.page_iab_categories=n.site.pagecat.map((function(e){return e.toString()})).sort().join(",").substring(0,32)),null!=n&&null!==(r=n.site)&&void 0!==r&&r.sectioncat&&Array.isArray(n.site.sectioncat)&&n.site.sectioncat.length>0&&(this.pixelData.section_iab_categories=n.site.sectioncat.map((function(e){return e.toString()})).sort().join(",").substring(0,32))}catch(e){console.warn("PrebidImpression: Error in addCategoryTracking",e)}}},{key:"getOrtb2FromBidRequest",value:function(e){try{return e.ortb2?e.ortb2:null}catch(e){return console.warn("PrebidImpression: Error getting ortb2 from bid request",e),null}}},{key:"extractBidderParams",value:function(t){try{if(!t||!t.params||"object"!==i(t.params))return null;for(var r={},n=["video","floor","floors","bidFloor","bidfloor","reserve","floorPrice","floorprice","customFloor","kadfloor","bidfloorcur","bidFloorCur","renderer"],o=0,a=Object.entries(t.params);o<a.length;o++){var s=(c=a[o],p=2,function(e){if(Array.isArray(e))return e}(c)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,n,o=[],a=!0,s=!1;try{for(t=t.call(e);!(a=(r=t.next()).done)&&(o.push(r.value),!i||o.length!==i);a=!0);}catch(e){s=!0,n=e}finally{try{a||null==t.return||t.return()}finally{if(s)throw n}}return o}}(c,p)||function(i,t){if(i){if("string"==typeof i)return e(i,t);var r=Object.prototype.toString.call(i).slice(8,-1);return"Object"===r&&i.constructor&&(r=i.constructor.name),"Map"===r||"Set"===r?Array.from(i):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?e(i,t):void 0}}(c,p)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),d=s[0],l=s[1];if(!n.includes(d)){var u=i(l);"string"!==u&&"number"!==u&&"boolean"!==u&&null!==l||(r[d]=l)}}return Object.keys(r).length>0?r:null}catch(e){return console.warn("Failed to extract bidder params:",e),null}var c,p}},{key:"checkEzids",value:function(){return"object"===i(window.ezoicIdentity)&&"function"==typeof window.ezoicIdentity.getUID&&"function"==typeof window.ezoicIdentity.isInternalUIDSource&&null!==window.ezoicIdentity.getUID()&&window.ezoicIdentity.isInternalUIDSource()?1:0}}]),r}();window.PrebidImpression=s}}();} catch(err) {var hREED = function(er) {return function() {reportEzError(er, "/detroitchicago/kenai.js")}}; typeof reportEzError==="function"?hREED(err):window.addEventListener('reportEzErrorDefined',hREED(err), {once: true}); console.error(err);}